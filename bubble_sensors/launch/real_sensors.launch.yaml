launch:

  - arg:
      name: use_dvl
      default: "true"

  - arg:
      name: use_imu
      default: "true"

  - arg:
      name: use_ekf
      default: "true"
  
  - arg: 
      name: dvl_timer_wait
      default: '10.0'

 #REMOVING THE VECTORNAV NODE FOR TESTING THE NEW VN100 Manager

  #- node:vectornav
      #if: $(var use_imu)
      #exec: vectornav
      #output: screen
      #param:
      #  - from: $(find-pkg-share bubble_sensors)/config/vectornav.yaml
  
  #- node:
      #pkg: vectornav  
      #if: $(var use_imu)
      #exec: vn_sensor_msgs
      #output: screen
      #param:
      #- from: $(find-pkg-share bubble_sensors)/config/vectornav.yaml
  
  - node: 
      pkg: bubble_sensors
      if: $(var use_imu)
      exec: vectornav_manager.py
      output: screen
        
  - node:
      pkg: dvl_a50
      if: $(var use_dvl)
      exec: dvl_a50_sensor
      output: screen
      param:
        - name: ip_address
          value: 192.168.194.95
          
  - node: 
      pkg: bubble_sensors
      if: $(var use_dvl)
      exec: dvl_enabler.py
      name: dvl_configurator
      param: 
        - name: timer_wait
          value: $(var dvl_timer_wait)

  - node: 
      pkg: bubble_sensors
      if: $(var use_dvl)
      exec: dvl_message_converter
      param: 
        - name: input_topic
          value: "/dvl/data"
        - name: output_topic
          value: "/dvl/twist_data"

  #Initializer Node:
        
  - node: 
      pkg: bubble_sensors
      exec: initializer.py
      output: screen
  
  # Define the transformations from the base link into the dvl and imu frames
  - node:
      pkg: tf2_ros
      exec: static_transform_publisher
      name: base_link_to_dvl
      args: --x -0.15 --y 0.0 --z -0.12 --roll 3.1416 --pitch 0.0 --yaw 3.1416 --frame-id base_link --child-frame-id dvl_a50

  - node:
      pkg: tf2_ros
      exec: static_transform_publisher
      name: base_link_to_vn100
      args: --x 0.0 --y 0.0 --z 0.05 --roll 1.5708 --pitch 0.0 --yaw 0.0 --frame-id base_link --child-frame-id vectornav 

  - include:
      if: $(var use_ekf)
      file: $(find-pkg-share bubble_sensors)/launch/real_ekf.launch.py
